using System;
using System.Collections.Generic;

namespace NodeFasadeG1.Jobs {
    public static class Font {
        const int charHeight=8, charSpacing=1, lineSpacing=1;


        // todo lowercase later
        static readonly Dictionary<char?, double[,]> Font8 = new Dictionary<char?, double[,]> {
            {'\uFFFD', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {1,1,1},
                {0,0,0},
            }},
            {'A', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {1,1,1},
                {1,0,1},
                {1,0,1},
                {0,0,0},
            }},
            {'Á', new double[8,3] { 
                {0,1,1},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {1,1,1},
                {1,0,1},
                {1,0,1},
                {0,0,0},
            }},
            {'B', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,0},
                {1,0,1},
                {1,1,0},
                {1,0,1},
                {1,1,0},
                {0,0,0},
            }},
            {'C', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,1},
                {1,0,0},
                {1,0,0},
                {1,0,0},
                {0,1,1},
                {0,0,0},
            }},
            {'Č', new double[8,3] { 
                {1,0,1},
                {0,1,0},
                {0,1,1},
                {1,0,0},
                {1,0,0},
                {1,0,0},
                {0,1,1},
                {0,0,0},
            }},
            {'D', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,0},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {1,1,0},
                {0,0,0},
            }},
            {'E', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,0},
                {1,1,0},
                {1,0,0},
                {1,1,1},
                {0,0,0},
            }},
            {'Ě', new double[8,3] { 
                {1,0,1},
                {0,1,0},
                {1,1,1},
                {1,0,0},
                {1,1,0},
                {1,0,0},
                {1,1,1},
                {0,0,0},
            }},
            {'F', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,0},
                {1,1,0},
                {1,0,0},
                {1,0,0},
                {0,0,0},
            }},
            {'G', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,1},
                {1,0,0},
                {1,0,1},
                {1,0,1},
                {0,1,1},
                {0,0,0},
            }},
            {'H', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {1,1,1},
                {1,0,1},
                {1,0,1},
                {0,0,0},
            }},
            {'I', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,1,0},
                {0,1,0},
                {0,1,0},
                {1,1,1},
                {0,0,0},
            }},
            {'Í', new double[8,3] { 
                {0,1,1},
                {0,0,0},
                {1,1,1},
                {0,1,0},
                {0,1,0},
                {0,1,0},
                {1,1,1},
                {0,0,0},
            }},
            {'J', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,0,1},
                {0,0,1},
                {1,0,1},
                {0,1,1},
                {0,0,0},
            }},
            {'K', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {1,1,0},
                {1,0,1},
                {1,0,1},
                {0,0,0},
            }},
            {'L', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,0},
                {1,0,0},
                {1,0,0},
                {1,0,0},
                {1,1,1},
                {0,0,0},
            }},
            {'O', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {1,1,1},
                {0,0,0},
            }},
            {'P', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,0},
                {1,0,1},
                {1,1,0},
                {1,0,0},
                {1,0,0},
                {0,0,0},
            }},
            {'Q', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {1,0,1},
                {1,1,1},
                {0,1,1},
                {0,0,0},
            }},
            {'T', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,1,0},
                {0,1,0},
                {0,1,0},
                {0,1,0},
                {0,0,0},
            }},
            {'M', new double[8,5] { 
                {0,0,0,0,0},
                {0,0,0,0,0},
                {1,0,1,0,1},
                {1,1,0,1,1},
                {1,0,0,0,1},
                {1,0,0,0,1},
                {1,0,0,0,1},
                {0,0,0,0,0},
            }},
            {'N', new double[8,4] { 
                {0,0,0,0},
                {0,0,0,0},
                {1,0,0,1},
                {1,1,0,1},
                {1,1,1,1},
                {1,0,1,1},
                {1,0,0,1},
                {0,0,0,0},
            }},
            {'R', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,0},
                {1,0,1},
                {1,1,0},
                {1,1,0},
                {1,0,1},
                {0,0,0},
            }},
            {'S', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,1},
                {1,0,0},
                {0,1,0},
                {0,0,1},
                {1,1,0},
                {0,0,0},
            }},
            {'U', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {1,1,1},
                {0,0,0},
            }},
            {'V', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {0,1,0},
                {0,1,0},
                {0,0,0},
            }},
            {'X', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {0,1,0},
                {1,0,1},
                {1,0,1},
                {0,0,0},
            }},
            {'Y', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {0,1,0},
                {0,1,0},
                {0,1,0},
                {0,0,0},
            }},
            {'Z', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,0,1},
                {0,1,0},
                {1,0,0},
                {1,1,1},
                {0,0,0},
            }},
            {'W', new double[8,5] {
                {0,0,0,0,0},
                {0,0,0,0,0},
                {1,0,0,0,1},
                {1,0,0,0,1},
                {1,0,1,0,1},
                {1,0,1,0,0},
                {0,1,0,1,0},
                {0,0,0,0,0},
            }},
            {'a', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,0},
                {0,0,1},
                {1,1,1},
                {1,1,1},
                {0,0,0},
            }},
            {'b', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,0},
                {1,0,0},
                {1,1,1},
                {1,0,1},
                {1,1,1},
                {0,0,0},
            }},
            {'c', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,0},
                {1,0,0},
                {1,1,1},
                {0,0,0},
            }},
            {'d', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,1},
                {1,1,1},
                {1,0,1},
                {1,0,1},
                {1,1,1},
                {0,0,0},
            }},
            {'e', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,0},
                {1,1,1},
                {1,1,1},
                {0,0,0},
            }},
            {'f', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,1},
                {0,1,0},
                {1,1,1},
                {0,1,0},
                {0,1,0},
                {0,0,0},
            }},
            {'g', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,1},
                {1,1,1},
                {0,0,1},
                {1,1,1},
            }},
            {'h', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,0},
                {1,1,1},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {0,0,0},
            }},
            {'i', new double[8,3] { 
                {0,0,0},
                {0,1,0},
                {0,0,0},
                {0,1,0},
                {1,1,0},
                {0,1,0},
                {1,1,1},
                {0,0,0},
            }},
            {'j', new double[8,2] { 
                {0,0},
                {0,1},
                {0,0},
                {0,1},
                {0,1},
                {0,1},
                {0,1},
                {1,0},
            }},
            {'k', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,0,0},
                {1,0,1},
                {1,1,0},
                {1,1,0},
                {1,0,1},
                {0,0,0},
            }},
            {'l', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,0},
                {0,1,0},
                {0,1,0},
                {0,1,0},
                {0,1,1},
                {0,0,0},
            }},
            {'o', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {1,0,1},
                {0,1,0},
                {0,0,0},
            }},
            {'p', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {1,0,1},
                {1,1,0},
                {1,0,0},
            }},
            {'q', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {1,0,1},
                {0,1,1},
                {0,0,1},
            }},
            {'m', new double[8,5] { 
                {0,0,0,0,0},
                {0,0,0,0,0},
                {0,0,0,0,0},
                {1,1,0,1,0},
                {1,0,1,0,1},
                {1,0,1,0,1},
                {1,0,1,0,1},
                {0,0,0,0,0},
            }},
            {'n', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {0,0,0},
            }},
            {'r', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,1,0},
                {1,0,0},
                {1,0,0},
                {0,0,0},
            }},
            {'s', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,1,1},
                {1,1,0},
                {0,0,1},
                {1,1,0},
                {0,0,0},
            }},
            {'t', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,1,1},
                {0,1,0},
                {0,1,0},
                {0,1,1},
                {0,0,0},
            }},
            {'u', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {1,1,1},
                {0,0,0},
            }},
            {'v', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {0,1,0},
                {0,0,0},
            }},
            {'w', new double[8,5] { 
                {0,0,0,0,0},
                {0,0,0,0,0},
                {0,0,0,0,0},
                {1,0,1,0,1},
                {1,0,1,0,1},
                {1,0,1,0,1},
                {0,1,0,1,0},
                {0,0,0,0,0},
            }},
            {'y', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {1,1,1},
                {0,0,1},
                {1,1,1},
            }},
            {'x', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,0,1},
                {0,1,0},
                {0,1,0},
                {1,0,1},
                {0,0,0},
            }},
            {'z', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,0,1},
                {0,1,0},
                {1,1,1},
                {0,0,0},
            }},
            {'1', new double[8,2] { 
                {0,0},
                {0,0},
                {0,1},
                {1,1},
                {0,1},
                {0,1},
                {0,1},
                {0,0},
            }},
            {'2', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {0,0,1},
                {0,1,0},
                {1,1,1},
                {0,0,0},
            }},
            {'3', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,0},
                {0,0,1},
                {0,1,1},
                {0,0,1},
                {1,1,0},
                {0,0,0},
            }},
            {'4', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,0},
                {1,1,1},
                {0,1,0},
                {0,1,0},
                {0,0,0},
            }},
            {'5', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {1,0,0},
                {1,1,0},
                {0,0,1},
                {1,1,0},
                {0,0,0},
            }},
            {'6', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,1},
                {1,0,0},
                {1,1,0},
                {1,0,1},
                {0,1,0},
                {0,0,0},
            }},
            {'7', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,0,1},
                {0,0,1},
                {0,1,0},
                {0,1,0},
                {0,0,0},
            }},
            {'8', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {0,1,0},
                {1,0,1},
                {0,1,0},
                {0,0,0},
            }},
            {'9', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {0,1,1},
                {0,0,1},
                {0,1,0},
                {0,0,0},
            }},
            {'0', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,0,1},
                {1,0,1},
                {1,0,1},
                {0,1,0},
                {0,0,0},
            }},
            {' ', new double[8,2] { 
                {0,0},
                {0,0},
                {0,0},
                {0,0},
                {0,0},
                {0,0},
                {0,0},
                {0,0},
            }},
            {'/', new double[8,2] { 
                {0,0},
                {0,0},
                {0,1},
                {0,1},
                {1,0},
                {1,0},
                {1,0},
                {0,0},
            }},
            {'\\', new double[8,2] { 
                {0,0},
                {0,0},
                {1,0},
                {1,0},
                {1,0},
                {0,1},
                {0,1},
                {0,0},
            }},
            {'*', new double[8,2] { 
                {0,0},
                {0,0},
                {1,1},
                {1,1},
                {0,0},
                {0,0},
                {0,0},
                {0,0},
            }},
            {'=', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,0,0},
                {1,1,1},
                {0,0,0},
                {0,0,0},
            }},
            {'"', new double[8,3] { 
                {0,0,0},
                {1,0,1},
                {1,0,1},
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
            }},
            {'\'', new double[8,3] { 
                {0,0,0},
                {0,1,0},
                {0,1,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
            }},
            {'.', new double[8,1] { 
                {0},
                {0},
                {0},
                {0},
                {0},
                {0},
                {1},
                {0},
            }},
            {',', new double[8,1] { 
                {0},
                {0},
                {0},
                {0},
                {0},
                {1},
                {1},
                {1},
            }},
            {';', new double[8,1] { 
                {0},
                {0},
                {0},
                {1},
                {0},
                {1},
                {1},
                {1},
            }},
            {':', new double[8,1] { 
                {0},
                {0},
                {0},
                {1},
                {0},
                {1},
                {0},
                {0},
            }},
            {'!', new double[8,1] { 
                {0},
                {0},
                {1},
                {1},
                {1},
                {0},
                {1},
                {0},
            }},
            {'+', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,1,0},
                {1,1,1},
                {0,1,0},
                {0,0,0},
                {0,0,0},
            }},
            {'-', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,0,0},
                {0,0,0},
                {0,0,0},
            }},
            {'?', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {1,1,0},
                {0,0,1},
                {0,1,0},
                {0,0,0},
                {0,1,0},
                {0,0,0},
            }},
            {'_', new double[8,3] { 
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {0,0,0},
                {1,1,1},
                {0,0,0},
            }},
            {'(', new double[8,2] { 
                {0,0},
                {0,1},
                {1,0},
                {1,0},
                {1,0},
                {1,0},
                {1,0},
                {0,1},
            }},
            {')', new double[8,2] { 
                {0,0},
                {1,0},
                {0,1},
                {0,1},
                {0,1},
                {0,1},
                {0,1},
                {1,0},
            }},
            {'[', new double[8,2] { 
                {0,0},
                {1,1},
                {1,0},
                {1,0},
                {1,0},
                {1,0},
                {1,0},
                {1,1},
            }},
            {']', new double[8,2] { 
                {0,0},
                {1,1},
                {0,1},
                {0,1},
                {0,1},
                {0,1},
                {0,1},
                {1,1},
            }},
            {'{', new double[8,3] { 
                {0,0,0},
                {0,0,1},
                {0,1,0},
                {0,1,0},
                {1,1,0},
                {0,1,0},
                {0,1,0},
                {0,0,1},
            }},
            {'}', new double[8,3] { 
                {0,0,0},
                {1,0,0},
                {0,1,0},
                {0,1,0},
                {0,1,1},
                {0,1,0},
                {0,1,0},
                {1,0,0},
            }},
            {'>', new double[8,2] { 
                {0,0},
                {0,0},
                {0,0},
                {1,0},
                {0,1},
                {0,1},
                {1,0},
                {0,0},
            }},
            {'<', new double[8,2] { 
                {0,0},
                {0,0},
                {0,0},
                {0,1},
                {1,0},
                {1,0},
                {0,1},
                {0,0},
            }},
        };

        public static double[,] GetChar(char chToDraw) { 
            Font8.TryGetValue(chToDraw, out double[,] data);
            if (data==null){ 
                Font8.TryGetValue('\uFFFD', out double[,] dataNull); 
                return dataNull;//never null
            }
            return data;
        }

        public static double[,] GetText(string stringToDraw) {
            string[] lines = stringToDraw
                .Replace("\r\n", "\n")
                .Split('\n');

            List<double[,]> renderedLines = new List<double[,]>();
            int maxWidth = 0;

            foreach (string line in lines) {
                double[,] lineData = RenderLine(line);
                renderedLines.Add(lineData);
                maxWidth = Math.Max(maxWidth, lineData.GetLength(1));
            }

            int totalHeight =
                lines.Length * charHeight +
                (lines.Length - 1) * lineSpacing;

            double[,] display = new double[totalHeight, maxWidth];

            int offsetY = 0;
            foreach (var line in renderedLines) {
                CopyLine(offsetY, line);
                offsetY += charHeight + lineSpacing;
            }

            return display;

            void CopyLine(int offsety, double[,] lineData) {
                for (int y = 0; y < lineData.GetLength(0); y++) {
                    for (int x = 0; x < lineData.GetLength(1); x++) {
                        display[offsety + y, x] = lineData[y, x];
                    }
                }
            }
        }

        static double[,] RenderLine(string line) {
            int stringLen = 0;
            List<double[,]> chars = new List<double[,]>();

            foreach (char ch in line) {
                var chData = GetChar(ch);
                chars.Add(chData);
                stringLen += chData.GetLength(1);
            }

            if (chars.Count>0) stringLen += (chars.Count-1) * charSpacing;

            double[,] lineDisplay = new double[charHeight, stringLen];

            int offsetX = 0;
            foreach (var ch in chars) {
                for (int y=0; y<charHeight; y++) {
                    for (int x=0; x<ch.GetLength(1); x++) {
                        lineDisplay[y, offsetX+x] = ch[y, x];
                    }
                }
                offsetX += ch.GetLength(1) + charSpacing;
            }

            return lineDisplay;
        }
    }
}
